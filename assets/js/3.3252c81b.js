(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{273:function(t,s,a){t.exports=a.p+"assets/img/ida_script_file.6d2dab25.png"},274:function(t,s){t.exports="data:image/png;base64,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"},275:function(t,s,a){t.exports=a.p+"assets/img/ida_export.7f66c5bd.png"},276:function(t,s,a){t.exports=a.p+"assets/img/ida_lua_so_export.c96499ef.png"},288:function(t,s,a){"use strict";a.r(s);var n=a(14),p=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"unity-i2cpp逆向"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unity-i2cpp逆向"}},[t._v("#")]),t._v(" unity-I2cpp逆向")]),t._v(" "),s("p",[t._v("对于I2cpp的逆向，主要步骤如下：")]),t._v(" "),s("ol",[s("li",[t._v("获取libil2cpp.so文件（未加密的可以从apk中提取，加密的可以从内存中dump）")]),t._v(" "),s("li",[t._v("获取metadata文件（从apk中提取，部分apk有加密，代码中可以找到解密方法）")]),t._v(" "),s("li",[t._v("使用"),s("a",{attrs:{href:"https://github.com/Perfare/Il2CppDumper",target:"_blank",rel:"noopener noreferrer"}},[t._v("Il2cppdumper"),s("OutboundLink")],1),t._v("还原DLL文件、dump.cs、方法名和常量等等")]),t._v(" "),s("li",[t._v("使用"),s("a",{attrs:{href:"https://github.com/dnSpy/dnSpy",target:"_blank",rel:"noopener noreferrer"}},[t._v("dnSpy"),s("OutboundLink")],1),t._v("反编译DLL文件，分析关键类和方法（基本上这里都只能看到方法名和类定义）")]),t._v(" "),s("li",[t._v("使用IDA分析libil2cpp.so，分析关键函数和逻辑，借助上上一步导入到IDA中，详见"),s("a",{attrs:{href:"https://github.com/Perfare/Il2CppDumper/blob/master/README.zh-CN.md#ida_with_structpy",target:"_blank",rel:"noopener noreferrer"}},[t._v("ida_with_structpy"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("分析游戏内是否有lua脚本，如果有，可以使用frida dump lua脚本，分析关键逻辑")]),t._v(" "),s("li",[t._v("dump出lua脚本，如果有加密，可以使用"),s("code",[t._v("unluac.jar")]),t._v("尝试解密")]),t._v(" "),s("li",[t._v("使用frida hook lua脚本，修改游戏逻辑，或者你想做的任何事情")])]),t._v(" "),s("h2",{attrs:{id:"_1-获取libil2cpp-so文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取libil2cpp-so文件"}},[t._v("#")]),t._v(" 1. 获取libil2cpp.so文件")]),t._v(" "),s("p",[t._v("apk文件本身就是一个zip文件，可以直接解压，然后在"),s("code",[t._v("lib\\armeabi-v7a")]),t._v("或者"),s("code",[t._v("lib\\arm64-v8a")]),t._v("目录下找到"),s("code",[t._v("libil2cpp.so")]),t._v("文件。如果更改成"),s("code",[t._v(".zip")]),t._v("文件后无法解压，那么通过010Editor打开，看文件头的部分是否是"),s("code",[t._v("PK")]),t._v("如果不是则改成"),s("code",[t._v("PK")]),t._v("。")]),t._v(" "),s("p",[t._v("如果是加密的，可以先尝试在内存中dump，若果还是加密的，则需要找到解密方法，这个暂时不做讨论。\n如果遇到可以试试"),s("a",{attrs:{href:"https://github.com/Perfare/Zygisk-Il2CppDumper/blob/master/README.zh-CN.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("Zygisk-Il2CppDumper"),s("OutboundLink")],1),t._v("工具")]),t._v(" "),s("p",[t._v("游戏厂商为了防止反编译，会对编译出来的apk包修改一些指定标识位，导致无法正常解压或反编译这个时候拿正常的apk对应把标识位进行修改即可。最常见的标识位修改是"),s("code",[t._v("zip")]),t._v("标识头。")]),t._v(" "),s("h2",{attrs:{id:"_2-获取metadata文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-获取metadata文件"}},[t._v("#")]),t._v(" 2. 获取metadata文件")]),t._v(" "),s("p",[t._v("metadata文件是一个二进制文件，在解压后的apk目录下，可以找到"),s("code",[t._v("assets\\bin\\Data\\Managed\\Metadata")]),t._v("目录，里面有一个"),s("code",[t._v("global-metadata.dat")]),t._v("文件，这个就是metadata文件。\n如果没有或者文件是加密的可以使用"),s("a",{attrs:{href:"https://github.com/IIIImmmyyy/frida-il2cppDumper",target:"_blank",rel:"noopener noreferrer"}},[t._v("frida-il2cppDumper"),s("OutboundLink")],1),t._v("从内存中dump出来。")]),t._v(" "),s("h2",{attrs:{id:"_3-使用il2cppdumper还原dll文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用il2cppdumper还原dll文件"}},[t._v("#")]),t._v(" 3. 使用Il2cppdumper还原DLL文件")]),t._v(" "),s("p",[t._v("下载"),s("a",{attrs:{href:"https://github.com/Perfare/Il2CppDumper/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("Il2CppDumper-win"),s("OutboundLink")],1),t._v("，双击打开，先选择"),s("code",[t._v("libil2cpp.so")]),t._v("、再选择"),s("code",[t._v("global-metadata.dat")]),t._v("文件，等待完成。\n完成后会生成"),s("code",[t._v("dump.cs")]),t._v("、"),s("code",[t._v("DummyDll")]),t._v("、"),s("code",[t._v("script.json")]),t._v("、"),s("code",[t._v("stringliteral.json")]),t._v("、"),s("code",[t._v("il2cpp.h")]),t._v("等文件。\nDummyDll内是还原出来的DLL文件，可以使用dnSpy打开，但是只能看到方法名和类定义，不能看到方法体。\n在"),s("code",[t._v("IDA")]),t._v("中可以使用"),s("code",[t._v("ida_with_struct_py3.py")]),t._v("脚本导入，可以让"),s("code",[t._v("IDA")]),t._v("的伪代码有结构定义。")]),t._v(" "),s("h2",{attrs:{id:"_4-使用dnspy反编译dll文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用dnspy反编译dll文件"}},[t._v("#")]),t._v(" 4. 使用dnSpy反编译DLL文件")]),t._v(" "),s("p",[t._v("下载"),s("a",{attrs:{href:"https://github.com/dnSpy/dnSpy/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("dnSpy"),s("OutboundLink")],1),t._v("\n使用dnSpy打开"),s("code",[t._v("DummyDll")]),t._v("文件夹，可以看到方法名和类定义，一般游戏内的自定义空间都会在"),s("code",[t._v("Assembly-CSharp.dll")]),t._v("中，可以关注这个DLL文件。")]),t._v(" "),s("h2",{attrs:{id:"_5-使用ida分析libil2cpp-so"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-使用ida分析libil2cpp-so"}},[t._v("#")]),t._v(" 5. 使用IDA分析libil2cpp.so")]),t._v(" "),s("ul",[s("li",[t._v("将"),s("code",[t._v("libil2cpp.so")]),t._v("文件拖入IDA中，等待分析完成（左下角地址码不跳）。")]),t._v(" "),s("li",[t._v("将上面步骤生成的定义加载到IDA中，"),s("code",[t._v("File->Script file")]),t._v("，选择"),s("code",[t._v("ida_with_struct_py3.py")]),t._v("脚本。\n"),s("img",{attrs:{src:a(273),alt:"ida_script_file.png"}}),t._v(" "),s("img",{attrs:{src:a(274),alt:"ida_script_file.png"}})]),t._v(" "),s("li",[t._v("之后依次选择"),s("code",[t._v("script.json")]),t._v("、"),s("code",[t._v("il2cpp.h")]),t._v("文件，等待加载完成。")]),t._v(" "),s("li",[t._v("可以看到IDA中的伪代码有结构定义了。")]),t._v(" "),s("li",[t._v("打开"),s("code",[t._v("dump.cs")]),t._v("根据"),s("code",[t._v("Offset: 0x000")]),t._v("地址在ida中找到对应的函数，分析逻辑。")]),t._v(" "),s("li",[t._v("补充一些IDA常用快捷键，\n"),s("ul",[s("li",[t._v("x 为搜索引用，")]),t._v(" "),s("li",[t._v("g 跳转到地址，")]),t._v(" "),s("li",[t._v("n 重命名，")]),t._v(" "),s("li",[t._v("/ 添加备注，")]),t._v(" "),s("li",[t._v("tab 切换视图，")]),t._v(" "),s("li",[t._v("space 切换hex和汇编视图。")])])])]),t._v(" "),s("h2",{attrs:{id:"_6-分析游戏内是否有lua脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-分析游戏内是否有lua脚本"}},[t._v("#")]),t._v(" 6. 分析游戏内是否有lua脚本")]),t._v(" "),s("p",[t._v("首先我们进入解压的apk内，在lib文件夹下，寻找关键词"),s("code",[t._v("lua")]),t._v("，例如"),s("code",[t._v("libluajit.so")]),t._v("、"),s("code",[t._v("libtolua.so")]),t._v("、"),s("code",[t._v("libxlua.so")]),t._v("如果看到这些so则大致可以判断游戏内存在"),s("code",[t._v("lua")]),t._v("脚本。\n游戏厂商为了游戏能实现热更新效果，不用每次更新版本都需要重新安装apk，都会将一部分逻辑放在lua脚本。\n找到so后，我们需要将so拖到IDA中进行分析，我们直接看导出表。\n"),s("img",{attrs:{src:a(275),alt:"ida_export.png"}}),t._v(" "),s("img",{attrs:{src:a(276),alt:"ida_lua_so_export.png"}}),t._v("\n可以看到有"),s("code",[t._v("luaL_loadbuffer")]),t._v("、"),s("code",[t._v("luaL_loadbufferx")]),t._v("、"),s("code",[t._v("luaL_loadfile")]),t._v("、"),s("code",[t._v("luaL_loadstring")]),t._v("等函数，这些函数都是lua脚本加载函数，这些函数都非常关键下面会提到。")]),t._v(" "),s("h2",{attrs:{id:"_7-dump出lua脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-dump出lua脚本"}},[t._v("#")]),t._v(" 7. dump出lua脚本")]),t._v(" "),s("p",[t._v("分析该so文件，根据分析所有的lua文件加载都会经过"),s("code",[t._v("luaL_loadbufferx")]),t._v("函数，所以我们只需要hook这个函数，就可以dump出所有的lua脚本。\n这里我们自己编写脚本来实现hook，大体步骤如下：")]),t._v(" "),s("ol",[s("li",[t._v("在游戏打开时立即hook")]),t._v(" "),s("li",[t._v("在导出表内找到"),s("code",[t._v("luaL_loadbufferx")]),t._v("函数的地址。")]),t._v(" "),s("li",[t._v("通过观察"),s("code",[t._v("luaL_loadbufferx")]),t._v("函数的参数，arg 0是lua env, arg 1是脚本content; arg 2是脚本size; arg 3脚本名称name")]),t._v(" "),s("li",[t._v("hook该函数，在"),s("code",[t._v("onEnter")]),t._v("时发送加载的lua文件到"),s("code",[t._v("py")]),t._v("。")]),t._v(" "),s("li",[t._v("将接收到的lua脚本，写入到指定目录内。")])]),t._v(" "),s("p",[t._v("编写该脚本如下：")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# dump_lua.py")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" time\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" frida\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys\n\njscode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v("\"\"\"\n    console.log('start hook')\n    var addr = Module.findExportByName('libtolua.so', 'luaL_loadbufferx');\n    while(addr == null) {\n        addr = Module.findExportByName('libtolua.so', 'luaL_loadbufferx');\n    }\n\n    console.log('addr', addr)\n    Interceptor.attach(addr, {\n        onEnter: function(args) {\n           var name = Memory.readUtf8String(args[3]);\n           var obj = {};\n           obj.size = args[2].toInt32()\n           obj.name = name;\n           obj.content = Memory.readByteArray(args[1], obj.size)\n           send(String(name), obj.content)\n       }\n    })\n\"\"\"")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'writh'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    folder "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        os"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("makedirs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("folder"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wb'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("write"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on_message")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'payload'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    content "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data\n    write"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"lua_script/"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.lua'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    device "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" frida"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get_remote_device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    pid "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("spawn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"your game package name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    session "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("attach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    device"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resume"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    time"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    script "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" session"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("create_script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jscode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"message"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" on_message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    script"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stdin"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("运行该脚本")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("python dump_lua.py\n")])])]),s("p",[t._v("打开游戏，可以看到lua脚本被dump到"),s("code",[t._v("lua_script")]),t._v("文件夹内，多点击游戏内的各个环节，尽量将游戏内的"),s("code",[t._v("lua")]),t._v("脚本都下载下来。")]),t._v(" "),s("h2",{attrs:{id:"_8-使用frida-hook-lua脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_8-使用frida-hook-lua脚本"}},[t._v("#")]),t._v(" 8. 使用frida hook lua脚本")]),t._v(" "),s("p",[t._v("在上面我们dump出了lua脚本，但是我们还需要分析lua脚本的逻辑，比如我们分析出来一个lua脚本是我们需要替换更改的，我们可以使用hook将此脚本替换为我们更改过的lua脚本。\n实现思路是：hook"),s("code",[t._v("luaL_loadbufferx")]),t._v("函数，当加载脚本时如果脚本在本地文件夹内存在，则读取本地文件夹内的脚本，否则加载原始脚本。\n实现代码如下:")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// lua_dump.js")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dump")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("filePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dataLen")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" dumpfile "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("File")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wb'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  dumpfile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("write")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readByteArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("dataLen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  dumpfile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'unity_dump_lua'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v("'filePath'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" filePath "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("access")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("filePath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ptr_access "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'libc.so'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'access'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" func_access "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NativeFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_access"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pointer'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ptr_filepath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUtf8String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("func_access")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_filepath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("Path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ptr_mkdir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'mkdir'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" func_mkdir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NativeFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_mkdir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pointer'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ptr_filepath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUtf8String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("func_mkdir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_filepath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("755")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("folder_mkdirs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" app_path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" p_list "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" pp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" app_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" p_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    pp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" p_list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("access")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("filePath")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ptr_open "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'libc.so'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'open'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" open "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NativeFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_open"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pointer'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ptr_read "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'libc.so'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'read'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" read "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NativeFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_read"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pointer'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ptr_close "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'libc.so'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'close'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" close "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NativeFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ptr_close"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("allocUtf8String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("filePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_file_size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alloc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("size "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[+] Unable to read DLL [!] '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" filePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("close")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" size "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_file_size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fd")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" statBuff "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alloc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fstatSymbol "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'libc.so'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fstat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fstat "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NativeFunction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fstatSymbol"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'int'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pointer'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fstat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" statBuff"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ret "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'[+] fstat --\x3e failed [!]'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readS32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("statBuff"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0x30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dump_lua")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("package_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("/data/data/")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("package_name"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("/luadump/")]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  Interceptor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("attach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("addr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onEnter")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("args")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// args[1] content; args[2] size; args[3] name")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Memory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readCString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("substring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lastIndexOf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("access")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("folder_mkdirs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" app_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("access")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'chunk'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Init'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'open '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' failed !'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NativePointer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ptr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeByteArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readByteArray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("size"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'load lua file :'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dump")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toInt32")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dump :'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" app_path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" addr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'libtolua.so'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'luaL_loadbufferx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("addr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  addr "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findExportByName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'libtolua.so'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'luaL_loadbufferx'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'start hook'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'addr'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dump_lua")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your package name'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" addr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("这里我们将"),s("code",[t._v("/data/data/${package_name}/luadump/")]),t._v("作为我们的脚本存放目录，在第一次运行的时候我们把加载的lua脚本dump到这个目录下，然后我们可以修改这个目录下的lua脚本，再次执行脚本，这时候我们的lua脚本就会被替换为我们修改过的lua脚本。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行脚本")]),t._v("\nfrida "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-U")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" your package name "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),t._v(" lua_dump.js "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--pause")]),t._v("\n")])])]),s("h2",{attrs:{id:"_9-其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_9-其他"}},[t._v("#")]),t._v(" 9. 其他")]),t._v(" "),s("ul",[s("li",[t._v("使用"),s("a",{attrs:{href:"https://github.com/skylot/jadx/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("jadx-gui"),s("OutboundLink")],1),t._v("反编译apk文件，查看游戏逻辑")]),t._v(" "),s("li",[t._v("使用"),s("a",{attrs:{href:"https://github.com/SeriousCache/UABE/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("AssetBundleExtractor"),s("OutboundLink")],1),t._v("分析unity游戏的静态资源文件，或者更改。")])])])}),[],!1,null,null,null);s.default=p.exports}}]);