<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>unity-I2cpp逆向 | jkcs 随记</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/jkcs-blog/assets/css/0.styles.ffa3548c.css" as="style"><link rel="preload" href="/jkcs-blog/assets/js/app.94e48d0b.js" as="script"><link rel="preload" href="/jkcs-blog/assets/js/2.733019b2.js" as="script"><link rel="preload" href="/jkcs-blog/assets/js/11.a37021bf.js" as="script"><link rel="prefetch" href="/jkcs-blog/assets/js/10.0213d8a9.js"><link rel="prefetch" href="/jkcs-blog/assets/js/12.27202502.js"><link rel="prefetch" href="/jkcs-blog/assets/js/3.64801815.js"><link rel="prefetch" href="/jkcs-blog/assets/js/4.d12742be.js"><link rel="prefetch" href="/jkcs-blog/assets/js/5.216cae74.js"><link rel="prefetch" href="/jkcs-blog/assets/js/6.2d0a63f8.js"><link rel="prefetch" href="/jkcs-blog/assets/js/7.2f3efbf1.js"><link rel="prefetch" href="/jkcs-blog/assets/js/8.b9fb1bc0.js"><link rel="prefetch" href="/jkcs-blog/assets/js/9.1ca5a2ba.js">
    <link rel="stylesheet" href="/jkcs-blog/assets/css/0.styles.ffa3548c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/jkcs-blog/" class="home-link router-link-active"><!----> <span class="site-name">jkcs 随记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>逆向与破解</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jkcs-blog/hack/frida.html" class="sidebar-link">frida介绍和基本使用</a></li><li><a href="/jkcs-blog/hack/unity-Il2cpp.html" aria-current="page" class="active sidebar-link">unity-I2cpp逆向</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_1-获取libil2cpp-so文件" class="sidebar-link">1. 获取libil2cpp.so文件</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_2-获取metadata文件" class="sidebar-link">2. 获取metadata文件</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_3-使用il2cppdumper还原dll文件" class="sidebar-link">3. 使用Il2cppdumper还原DLL文件</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_4-使用dnspy反编译dll文件" class="sidebar-link">4. 使用dnSpy反编译DLL文件</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_5-使用ida分析libil2cpp-so" class="sidebar-link">5. 使用IDA分析libil2cpp.so</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_6-分析游戏内是否有lua脚本" class="sidebar-link">6. 分析游戏内是否有lua脚本</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_7-dump出lua脚本" class="sidebar-link">7. dump出lua脚本</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_8-使用frida-hook-lua脚本" class="sidebar-link">8. 使用frida hook lua脚本</a></li><li class="sidebar-sub-header"><a href="/jkcs-blog/hack/unity-Il2cpp.html#_9-其他" class="sidebar-link">9. 其他</a></li></ul></li><li><a href="/jkcs-blog/hack/android-inject.html" class="sidebar-link">Android 注入的三种注入方式</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>js相关内容</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jkcs-blog/js/utils.html" class="sidebar-link">一些好用的js代码</a></li></ul></section></li><li><a href="/jkcs-blog/about.html" class="sidebar-link">关于此博客</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="unity-i2cpp逆向"><a href="#unity-i2cpp逆向" class="header-anchor">#</a> unity-I2cpp逆向</h1> <p>对于I2cpp的逆向，主要步骤如下：</p> <ol><li>获取libil2cpp.so文件（未加密的可以从apk中提取，加密的可以从内存中dump）</li> <li>获取metadata文件（从apk中提取，部分apk有加密，代码中可以找到解密方法）</li> <li>使用<a href="https://github.com/Perfare/Il2CppDumper" target="_blank" rel="noopener noreferrer">Il2cppdumper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>还原DLL文件、dump.cs、方法名和常量等等</li> <li>使用<a href="https://github.com/dnSpy/dnSpy" target="_blank" rel="noopener noreferrer">dnSpy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>反编译DLL文件，分析关键类和方法（基本上这里都只能看到方法名和类定义）</li> <li>使用IDA分析libil2cpp.so，分析关键函数和逻辑，借助上上一步导入到IDA中，详见<a href="https://github.com/Perfare/Il2CppDumper/blob/master/README.zh-CN.md#ida_with_structpy" target="_blank" rel="noopener noreferrer">ida_with_structpy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>分析游戏内是否有lua脚本，如果有，可以使用frida dump lua脚本，分析关键逻辑</li> <li>dump出lua脚本，如果有加密，可以使用<code>unluac.jar</code>尝试解密</li> <li>使用frida hook lua脚本，修改游戏逻辑，或者你想做的任何事情</li></ol> <h2 id="_1-获取libil2cpp-so文件"><a href="#_1-获取libil2cpp-so文件" class="header-anchor">#</a> 1. 获取libil2cpp.so文件</h2> <p>apk文件本身就是一个zip文件，可以直接解压，然后在<code>lib\armeabi-v7a</code>或者<code>lib\arm64-v8a</code>目录下找到<code>libil2cpp.so</code>文件。如果更改成<code>.zip</code>文件后无法解压，那么通过010Editor打开，看文件头的部分是否是<code>PK</code>如果不是则改成<code>PK</code>。</p> <p>如果是加密的，可以先尝试在内存中dump，若果还是加密的，则需要找到解密方法，这个暂时不做讨论。
如果遇到可以试试<a href="https://github.com/Perfare/Zygisk-Il2CppDumper/blob/master/README.zh-CN.md" target="_blank" rel="noopener noreferrer">Zygisk-Il2CppDumper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>工具</p> <p>游戏厂商为了防止反编译，会对编译出来的apk包修改一些指定标识位，导致无法正常解压或反编译这个时候拿正常的apk对应把标识位进行修改即可。最常见的标识位修改是<code>zip</code>标识头。</p> <h2 id="_2-获取metadata文件"><a href="#_2-获取metadata文件" class="header-anchor">#</a> 2. 获取metadata文件</h2> <p>metadata文件是一个二进制文件，在解压后的apk目录下，可以找到<code>assets\bin\Data\Managed\Metadata</code>目录，里面有一个<code>global-metadata.dat</code>文件，这个就是metadata文件。
如果没有或者文件是加密的可以使用<a href="https://github.com/IIIImmmyyy/frida-il2cppDumper" target="_blank" rel="noopener noreferrer">frida-il2cppDumper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>从内存中dump出来。</p> <h2 id="_3-使用il2cppdumper还原dll文件"><a href="#_3-使用il2cppdumper还原dll文件" class="header-anchor">#</a> 3. 使用Il2cppdumper还原DLL文件</h2> <p>下载<a href="https://github.com/Perfare/Il2CppDumper/releases" target="_blank" rel="noopener noreferrer">Il2CppDumper-win<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，双击打开，先选择<code>libil2cpp.so</code>、再选择<code>global-metadata.dat</code>文件，等待完成。
完成后会生成<code>dump.cs</code>、<code>DummyDll</code>、<code>script.json</code>、<code>stringliteral.json</code>、<code>il2cpp.h</code>等文件。
DummyDll内是还原出来的DLL文件，可以使用dnSpy打开，但是只能看到方法名和类定义，不能看到方法体。
在<code>IDA</code>中可以使用<code>ida_with_struct_py3.py</code>脚本导入，可以让<code>IDA</code>的伪代码有结构定义。</p> <h2 id="_4-使用dnspy反编译dll文件"><a href="#_4-使用dnspy反编译dll文件" class="header-anchor">#</a> 4. 使用dnSpy反编译DLL文件</h2> <p>下载<a href="https://github.com/dnSpy/dnSpy/releases" target="_blank" rel="noopener noreferrer">dnSpy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
使用dnSpy打开<code>DummyDll</code>文件夹，可以看到方法名和类定义，一般游戏内的自定义空间都会在<code>Assembly-CSharp.dll</code>中，可以关注这个DLL文件。</p> <h2 id="_5-使用ida分析libil2cpp-so"><a href="#_5-使用ida分析libil2cpp-so" class="header-anchor">#</a> 5. 使用IDA分析libil2cpp.so</h2> <ul><li>将<code>libil2cpp.so</code>文件拖入IDA中，等待分析完成（左下角地址码不跳）。</li> <li>将上面步骤生成的定义加载到IDA中，<code>File-&gt;Script file</code>，选择<code>ida_with_struct_py3.py</code>脚本。
<img src="images/ida_script_file.png" alt="ida_script_file.png"> <img src="images/ida_script_file_i2cpp_py.png" alt="ida_script_file.png"></li> <li>之后依次选择<code>script.json</code>、<code>il2cpp.h</code>文件，等待加载完成。</li> <li>可以看到IDA中的伪代码有结构定义了。</li> <li>打开<code>dump.cs</code>根据<code>Offset: 0x000</code>地址在ida中找到对应的函数，分析逻辑。</li> <li>补充一些IDA常用快捷键，
<ul><li>x 为搜索引用，</li> <li>g 跳转到地址，</li> <li>n 重命名，</li> <li>/ 添加备注，</li> <li>tab 切换视图，</li> <li>space 切换hex和汇编视图。</li></ul></li></ul> <h2 id="_6-分析游戏内是否有lua脚本"><a href="#_6-分析游戏内是否有lua脚本" class="header-anchor">#</a> 6. 分析游戏内是否有lua脚本</h2> <p>首先我们进入解压的apk内，在lib文件夹下，寻找关键词<code>lua</code>，例如<code>libluajit.so</code>、<code>libtolua.so</code>、<code>libxlua.so</code>如果看到这些so则大致可以判断游戏内存在<code>lua</code>脚本。
游戏厂商为了游戏能实现热更新效果，不用每次更新版本都需要重新安装apk，都会将一部分逻辑放在lua脚本。
找到so后，我们需要将so拖到IDA中进行分析，我们直接看导出表。
<img src="images/ida_export.png" alt="ida_export.png"> <img src="images/ida_lua_so_export.png" alt="ida_lua_so_export.png">
可以看到有<code>luaL_loadbuffer</code>、<code>luaL_loadbufferx</code>、<code>luaL_loadfile</code>、<code>luaL_loadstring</code>等函数，这些函数都是lua脚本加载函数，这些函数都非常关键下面会提到。</p> <h2 id="_7-dump出lua脚本"><a href="#_7-dump出lua脚本" class="header-anchor">#</a> 7. dump出lua脚本</h2> <p>分析该so文件，根据分析所有的lua文件加载都会经过<code>luaL_loadbufferx</code>函数，所以我们只需要hook这个函数，就可以dump出所有的lua脚本。
这里我们自己编写脚本来实现hook，大体步骤如下：</p> <ol><li>在游戏打开时立即hook</li> <li>在导出表内找到<code>luaL_loadbufferx</code>函数的地址。</li> <li>通过观察<code>luaL_loadbufferx</code>函数的参数，arg 0是lua env, arg 1是脚本content; arg 2是脚本size; arg 3脚本名称name</li> <li>hook该函数，在<code>onEnter</code>时发送加载的lua文件到<code>py</code>。</li> <li>将接收到的lua脚本，写入到指定目录内。</li></ol> <p>编写该脚本如下：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># dump_lua.py</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> frida
<span class="token keyword">import</span> sys

jscode <span class="token operator">=</span> <span class="token triple-quoted-string string">&quot;&quot;&quot;
    console.log('start hook')
    var addr = Module.findExportByName('libtolua.so', 'luaL_loadbufferx');
    while(addr == null) {
        addr = Module.findExportByName('libtolua.so', 'luaL_loadbufferx');
    }

    console.log('addr', addr)
    Interceptor.attach(addr, {
        onEnter: function(args) {
           var name = Memory.readUtf8String(args[3]);
           var obj = {};
           obj.size = args[2].toInt32()
           obj.name = name;
           obj.content = Memory.readByteArray(args[1], obj.size)
           send(String(name), obj.content)
       }
    })
&quot;&quot;&quot;</span>

<span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'writh'</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span>
    folder <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>folder<span class="token punctuation">)</span><span class="token punctuation">:</span>
        os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>folder<span class="token punctuation">)</span>
    <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>content<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">on_message</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> message<span class="token punctuation">[</span><span class="token string">'payload'</span><span class="token punctuation">]</span>
    content <span class="token operator">=</span> data
    write<span class="token punctuation">(</span><span class="token string">&quot;lua_script/&quot;</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">'.lua'</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    device <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_remote_device<span class="token punctuation">(</span><span class="token punctuation">)</span>
    pid <span class="token operator">=</span> device<span class="token punctuation">.</span>spawn<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;your game package name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    session <span class="token operator">=</span> device<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>pid<span class="token punctuation">)</span>
    device<span class="token punctuation">.</span>resume<span class="token punctuation">(</span>pid<span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    script <span class="token operator">=</span> session<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span>

    script<span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> on_message<span class="token punctuation">)</span>
    script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>运行该脚本</p> <div class="language-shell extra-class"><pre class="language-shell"><code>python dump_lua.py
</code></pre></div><p>打开游戏，可以看到lua脚本被dump到<code>lua_script</code>文件夹内，多点击游戏内的各个环节，尽量将游戏内的<code>lua</code>脚本都下载下来。</p> <h2 id="_8-使用frida-hook-lua脚本"><a href="#_8-使用frida-hook-lua脚本" class="header-anchor">#</a> 8. 使用frida hook lua脚本</h2> <p>在上面我们dump出了lua脚本，但是我们还需要分析lua脚本的逻辑，比如我们分析出来一个lua脚本是我们需要替换更改的，我们可以使用hook将此脚本替换为我们更改过的lua脚本。
实现思路是：hook<code>luaL_loadbufferx</code>函数，当加载脚本时如果脚本在本地文件夹内存在，则读取本地文件夹内的脚本，否则加载原始脚本。
实现代码如下:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// lua_dump.js</span>
<span class="token keyword">function</span> <span class="token function">dump</span><span class="token punctuation">(</span><span class="token parameter">filePath<span class="token punctuation">,</span> data<span class="token punctuation">,</span> dataLen</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dumpfile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  dumpfile<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">readByteArray</span><span class="token punctuation">(</span>dataLen<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  dumpfile<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'unity_dump_lua'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">'filePath'</span><span class="token operator">:</span> filePath <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">access</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ptr_access <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">,</span> <span class="token string">'access'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> func_access <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeFunction</span><span class="token punctuation">(</span>ptr_access<span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'pointer'</span><span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ptr_filepath <span class="token operator">=</span> Memory<span class="token punctuation">.</span><span class="token function">allocUtf8String</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">func_access</span><span class="token punctuation">(</span>ptr_filepath<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token parameter">Path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ptr_mkdir <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'mkdir'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> func_mkdir <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeFunction</span><span class="token punctuation">(</span>ptr_mkdir<span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'pointer'</span><span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ptr_filepath <span class="token operator">=</span> Memory<span class="token punctuation">.</span><span class="token function">allocUtf8String</span><span class="token punctuation">(</span>Path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">func_mkdir</span><span class="token punctuation">(</span>ptr_filepath<span class="token punctuation">,</span> <span class="token number">755</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">folder_mkdirs</span><span class="token punctuation">(</span><span class="token parameter">p<span class="token punctuation">,</span> app_path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> p_list <span class="token operator">=</span> p<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> pp <span class="token operator">=</span> app_path<span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> p_list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pp <span class="token operator">=</span> pp <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> p_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">access</span><span class="token punctuation">(</span>pp<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">mkdir</span><span class="token punctuation">(</span>pp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">readFile</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ptr_open <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">,</span> <span class="token string">'open'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> open <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeFunction</span><span class="token punctuation">(</span>ptr_open<span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'pointer'</span><span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ptr_read <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">,</span> <span class="token string">'read'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> read <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeFunction</span><span class="token punctuation">(</span>ptr_read<span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token string">'pointer'</span><span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> ptr_close <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">,</span> <span class="token string">'close'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> close <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeFunction</span><span class="token punctuation">(</span>ptr_close<span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'int'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> fd <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span>Memory<span class="token punctuation">.</span><span class="token function">allocUtf8String</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token function">get_file_size</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>size <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> Memory<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> data<span class="token punctuation">,</span> size<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[+] Unable to read DLL [!] '</span> <span class="token operator">+</span> filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> data<span class="token punctuation">,</span> <span class="token literal-property property">size</span><span class="token operator">:</span> size <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">get_file_size</span><span class="token punctuation">(</span><span class="token parameter">fd</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> statBuff <span class="token operator">=</span> Memory<span class="token punctuation">.</span><span class="token function">alloc</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> fstatSymbol <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token string">'libc.so'</span><span class="token punctuation">,</span> <span class="token string">'fstat'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> fstat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativeFunction</span><span class="token punctuation">(</span>fstatSymbol<span class="token punctuation">,</span> <span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'int'</span><span class="token punctuation">,</span> <span class="token string">'pointer'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fd <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token function">fstat</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> statBuff<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'[+] fstat --&gt; failed [!]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> Memory<span class="token punctuation">.</span><span class="token function">readS32</span><span class="token punctuation">(</span>statBuff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0x30</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">dump_lua</span><span class="token punctuation">(</span><span class="token parameter">package_name<span class="token punctuation">,</span> addr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app_path <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/data/data/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>package_name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/luadump/</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  Interceptor<span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">onEnter</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// args[1] content; args[2] size; args[3] name</span>
      <span class="token keyword">const</span> name <span class="token operator">=</span> Memory<span class="token punctuation">.</span><span class="token function">readCString</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>name<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">50</span> <span class="token operator">&amp;&amp;</span> name<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> path <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> name<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">access</span><span class="token punctuation">(</span>app_path <span class="token operator">+</span> path<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">folder_mkdirs</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> app_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">access</span><span class="token punctuation">(</span>app_path <span class="token operator">+</span> name<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">!==</span> <span class="token string">'chunk'</span> <span class="token operator">&amp;&amp;</span> name <span class="token operator">!==</span> <span class="token string">'Init'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">readFile</span><span class="token punctuation">(</span>app_path <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token string">'open '</span> <span class="token operator">+</span> app_path <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">' failed !'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NativePointer</span><span class="token punctuation">(</span><span class="token function">ptr</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">writeByteArray</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">readByteArray</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'load lua file :'</span> <span class="token operator">+</span> app_path <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token function">dump</span><span class="token punctuation">(</span>app_path <span class="token operator">+</span> name<span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toInt32</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dump :'</span> <span class="token operator">+</span> app_path <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> addr <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token string">'libtolua.so'</span><span class="token punctuation">,</span> <span class="token string">'luaL_loadbufferx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>addr <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  addr <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">findExportByName</span><span class="token punctuation">(</span><span class="token string">'libtolua.so'</span><span class="token punctuation">,</span> <span class="token string">'luaL_loadbufferx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start hook'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'addr'</span><span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">dump_lua</span><span class="token punctuation">(</span><span class="token string">'your package name'</span><span class="token punctuation">,</span> addr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这里我们将<code>/data/data/${package_name}/luadump/</code>作为我们的脚本存放目录，在第一次运行的时候我们把加载的lua脚本dump到这个目录下，然后我们可以修改这个目录下的lua脚本，再次执行脚本，这时候我们的lua脚本就会被替换为我们修改过的lua脚本。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 执行脚本</span>
frida <span class="token parameter variable">-U</span> <span class="token parameter variable">-f</span> your package name <span class="token parameter variable">-l</span> lua_dump.js <span class="token parameter variable">--pause</span>
</code></pre></div><h2 id="_9-其他"><a href="#_9-其他" class="header-anchor">#</a> 9. 其他</h2> <ul><li>使用<a href="https://github.com/skylot/jadx/releases" target="_blank" rel="noopener noreferrer">jadx-gui<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>反编译apk文件，查看游戏逻辑</li> <li>使用<a href="https://github.com/SeriousCache/UABE/releases" target="_blank" rel="noopener noreferrer">AssetBundleExtractor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>分析unity游戏的静态资源文件，或者更改。</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/5/2023, 2:19:18 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/jkcs-blog/hack/frida.html" class="prev">
        frida介绍和基本使用
      </a></span> <span class="next"><a href="/jkcs-blog/hack/android-inject.html">
        Android 注入的三种注入方式
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/jkcs-blog/assets/js/app.94e48d0b.js" defer></script><script src="/jkcs-blog/assets/js/2.733019b2.js" defer></script><script src="/jkcs-blog/assets/js/11.a37021bf.js" defer></script>
  </body>
</html>
